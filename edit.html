<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Domino ¬∑ Cozy Editor</title>
<style>
  :root{
    --bg:#3b2a42; --panel:#4a3657; --accent:#e6a8ff; --accent2:#ffda8b;
  }
  body{margin:0; min-height:100vh; background:var(--bg); color:#fdf4ff; font:500 16px "Inter", system-ui;
       display:flex; flex-direction:column; align-items:center; justify-content:center; padding:20px}
  h1{margin:12px 0 20px; font-size:28px; color:var(--accent2); text-shadow:0 0 8px rgba(255,218,139,.7)}
  .panel{background:var(--panel); padding:24px; border-radius:16px; display:flex; flex-direction:column;
         align-items:center; gap:14px; box-shadow:0 4px 20px rgba(0,0,0,.4); width:340px}
  textarea{width:100%; height:100px; padding:12px; border-radius:10px; border:2px solid var(--accent);
           background:#fffaf5; color:#2c1a32; font-size:15px; resize:none}
  label{font-size:14px; display:flex; align-items:center; gap:8px}
  input[type=checkbox]{transform:scale(1.2)}
  .btn{padding:12px 20px; border-radius:10px; border:none; background:var(--accent2); color:#2c1a32;
       cursor:pointer; font-weight:700; font-size:15px; transition:all .2s}
  .btn:hover{transform:scale(1.05)}
  .note{font-size:13px; color:#ddd; text-align:center; margin-top:8px}
  #embedCodeBox{display:none; margin-top:16px; text-align:center; width:100%}
  #embedCode{width:100%; height:80px; border-radius:10px; border:2px solid var(--accent); padding:8px; font-size:13px}
</style>
</head>
<body>
  <h1>Domino ¬∑ Cozy Editor</h1>
  <div class="panel">
    <textarea id="listA" placeholder="–°–ø–∏—Å–æ–∫ A (–Ω–∞–ø—Ä–∏–º–µ—Ä: CAT, DOG, SUN –∏–ª–∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏)"></textarea>
    <textarea id="listB" placeholder="–°–ø–∏—Å–æ–∫ B (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: üê±, üê∂, ‚òÄÔ∏è)"></textarea>

    <label><input type="checkbox" id="freeMode"> –°–≤–æ–±–æ–¥–Ω–∞—è –∏–≥—Ä–∞ (–±–µ–∑ –ø—Ä–∞–≤–∏–ª)</label>

    <button id="saveBtn" class="btn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞–±–æ—Ä</button>
    <p class="note">–ü–æ—Å–ª–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –ø–æ—è–≤–∏—Ç—Å—è –∫–æ–¥ –¥–ª—è –≤—Å—Ç–∞–≤–∫–∏ –≤ Genially</p>

    <div id="embedCodeBox">
      <p>–°–∫–æ–ø–∏—Ä—É–π —ç—Ç–æ—Ç –∫–æ–¥ –∏ –≤—Å—Ç–∞–≤—å –≤ Genially:</p>
      <textarea id="embedCode" readonly></textarea>
    </div>
  </div>

<script>
function buildDeckClassic(list) {
  var out=[];
  for (var i=0;i<list.length;i++){
    for (var j=i;j<list.length;j++){
      out.push({a:list[i], b:list[j]});
    }
  }
  return out;
}
function buildDeckAdvanced(listA, listB) {
  var out=[];
  out = out.concat(buildDeckClassic(listA)); // —Å–ª–æ–≤–∞
  out = out.concat(buildDeckClassic(listB)); // –∫–∞—Ä—Ç–∏–Ω–∫–∏
  for (var k=0;k<listA.length && k<listB.length;k++){ // –º–æ—Å—Ç–∏–∫–∏ —Å–ª–æ–≤–æ ‚Üî –∫–∞—Ä—Ç–∏–Ω–∫–∞
    out.push({a:listA[k], b:listB[k]});
  }
  return out;
}

function showEmbedCode() {
  const url = window.location.origin + window.location.pathname.replace("edit.html","main.html");
  const code = `<iframe src="${url}" width="960" height="540" style="border:0;" allowfullscreen></iframe>`;
  document.getElementById("embedCode").value = code;
  document.getElementById("embedCodeBox").style.display = "block";
}

document.getElementById("saveBtn").addEventListener("click", ()=>{
  var listA = document.getElementById("listA").value.split(",").map(w=>w.trim()).filter(Boolean);
  var listB = document.getElementById("listB").value.split(",").map(w=>w.trim()).filter(Boolean);
  var freeMode = document.getElementById("freeMode").checked;

  if (!listA.length) {
    alert("–í–≤–µ–¥–∏—Ç–µ —Ö–æ—Ç—è –±—ã –æ–¥–∏–Ω —ç–ª–µ–º–µ–Ω—Ç –≤ —Å–ø–∏—Å–æ–∫ A");
    return;
  }

  var deck;
  if (listB.length) {
    deck = buildDeckAdvanced(listA, listB);
  } else {
    deck = buildDeckClassic(listA);
  }

  localStorage.setItem("dominoDeck", JSON.stringify({deck:deck, freeMode:freeMode}));
  alert("‚úÖ –ù–∞–±–æ—Ä —Å–æ—Ö—Ä–∞–Ω—ë–Ω!");
  showEmbedCode();
});
</script>
</body>
</html>
