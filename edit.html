<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Domino Editor</title>

<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —à—Ä–∏—Ñ—Ç Inter -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
  body{
    margin:0;
    padding:0;
    background: url("https://img.genially.com/64233afb55129a0017751c8e/80454769-7ad4-4911-b11a-636485807651.jpeg") no-repeat center center fixed;
    background-size:cover;
    font:18px "Inter", sans-serif;
    color:#fdf4ff;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:flex-start;
    min-height:100vh;
    text-align:center;
    position:relative;
    overflow:hidden; /* —É–±–∏—Ä–∞–µ–º —Å–∫—Ä–æ–ª–ª */
  }

  h1{
    margin:10px 0;
    font-size:2.6em;
    color:#ffeeb0;
    text-shadow:0 0 8px #ffae00, 0 0 16px #d06bff;
    position:relative; z-index:2;
  }

  .logo{
    margin:10px auto 0;
    width:120px;
    filter: drop-shadow(0 0 10px #ffda8b);
    position:relative; z-index:2;
  }

  /* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ */
  .lists {
    display: flex;
    justify-content: center;
    gap: 20px;
    width: 90%;
    max-width: 900px;
    margin: 10px auto;
    position:relative;
    z-index:2;
  }
  .list-col {
    flex: 1;
    min-width: 0;
  }
  .list-col p {
    font-size: 16px;
    background:rgba(46,25,56,0.6);
    padding:8px 14px;
    border-radius:8px;
    margin-bottom:8px;
    box-shadow:0 0 8px rgba(255,126,255,.4);
  }
  .list-col textarea {
    width: 100%;
    min-height: 120px;
    padding:14px 16px;
    border-radius:12px;
    border:2px solid #ffda8b;
    background:rgba(255,255,255,0.9);
    color:#2c1a32;
    font-size:16px;
    box-shadow:0 0 10px rgba(255,218,139,.6);
  }

  label{
    margin:10px auto;
    display:flex;
    align-items:center;
    gap:8px;
    font-size:16px;
    background:rgba(46,25,56,0.6);
    padding:8px 14px;
    border-radius:8px;
    max-width:650px;
    box-shadow:0 0 8px rgba(255,126,255,.4);
    position:relative; z-index:2;
  }

  p.feedback-label {
    font-size:16px;
    background:rgba(46,25,56,0.6);
    padding:8px 14px;
    border-radius:8px;
    margin:12px auto;
    max-width:650px;
    box-shadow:0 0 8px rgba(255,126,255,.4);
    position:relative; z-index:2;
  }

  textarea#feedbackText {
    width:90%;
    max-width:800px;
    min-height:80px;
    margin:12px auto;
    padding:14px 16px;
    border-radius:12px;
    border:2px solid #ffda8b;
    background:rgba(255,255,255,0.9);
    color:#2c1a32;
    font-size:16px;
    box-shadow:0 0 10px rgba(255,218,139,.6);
    display:block;
    position:relative; z-index:2;
  }

  button{
    padding:14px 28px; border-radius:12px; border:none;
    background:linear-gradient(90deg,#ffda8b,#ff7eff);
    color:#2c1a32; cursor:pointer; font-weight:700; font-size:18px; margin:16px 0;
    box-shadow:0 0 12px rgba(255,218,139,.8),0 0 20px rgba(208,107,255,.7);
    transition:transform .2s, box-shadow .2s;
    position:relative; z-index:2;
  }
  button:hover{
    transform:scale(1.05);
    box-shadow:0 0 16px #ffda8b,0 0 28px #d06bff;
  }

  #embedCodeBox{
    display:none;
    margin-top:12px;
    width:90%;
    max-width:800px;
    text-align:center;
    position:relative; z-index:2;
  }
  #embedCode{
    width:100%;
    min-height:100px;
    padding:14px;
    border-radius:12px;
    background:rgba(30,16,34,0.9);
    color:#ffda8b;
    font-family:monospace;
    font-size:15px;
    border:2px solid #ff7eff;
    box-shadow:0 0 12px rgba(255,126,255,.6);
    text-align:left;
    display:block;
    margin:0 auto;
  }

  /* –≥–∏—Ä–ª—è–Ω–¥–∞ */
  .garland{
    position:fixed;
    top:10px;
    left:0;
    width:100%;
    display:flex;
    justify-content:space-evenly;
    pointer-events:none;
    z-index:1;
  }
  .garland span{
    width:20px; height:20px; border-radius:50%;
    background:#ffda8b; box-shadow:0 0 8px #ffda8b;
    animation: blink 1.5s infinite alternate;
  }
  .garland span:nth-child(2n){background:#ff7eff; box-shadow:0 0 8px #ff7eff; animation-delay:.3s}
  .garland span:nth-child(3n){background:#7ef9ff; box-shadow:0 0 8px #7ef9ff; animation-delay:.6s}
  @keyframes blink{from{opacity:.4} to{opacity:1}}
</style>
</head>
<body>

  <!-- –≤–µ—Ä—Ö–Ω—è—è –≥–∏—Ä–ª—è–Ω–¥–∞ -->
  <div class="garland" id="garlandTop"></div>

  <img src="https://con.xl.ru/fnfLZuvpAUiDaqDs8d1-2g/images/kcJYv7OsYUSGt5AfGq5jIw.png" alt="–õ–æ–≥–æ –ö–ì–ë" class="logo">
  <h1>–ö–ì–ë ¬∑ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ "–î–æ–º–∏–Ω–æ"</h1>

  <div class="lists">
    <div class="list-col">
      <p>–í–≤–µ–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ A (—Å–ª–æ–≤–∞ –∏–ª–∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏):</p>
      <textarea id="listA" placeholder="CAT, DOG, SUN, MOON"></textarea>
    </div>
    <div class="list-col">
      <p>–í–≤–µ–¥–∏—Ç–µ —Å–ø–∏—Å–æ–∫ B (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏–ª–∏ —Å–ª–æ–≤–∞ –¥–ª—è –ø–∞—Ä):</p>
      <textarea id="listB" placeholder="üê±, üê∂, ‚òÄÔ∏è, üåô"></textarea>
    </div>
  </div>

<label><input type="checkbox" id="freeMode"> –°–≤–æ–±–æ–¥–Ω–∞—è –∏–≥—Ä–∞ (–±–µ–∑ –ø—Ä–∞–≤–∏–ª)</label>

<!-- ‚úö –ù–û–í–û–ï: –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å —Å–µ—Ä–≤–µ—Ä–Ω–æ–π –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ -->
<label><input type="checkbox" id="useServer"> –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–∫–æ—Ä–æ—Ç–∫–∏–π iframe —Å ?id=)</label>

<p class="feedback-label">–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ñ–∏–¥–±–µ–∫–∞ (—Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø–æ–±–µ–¥—ã):</p>

  <textarea id="feedbackText" placeholder="–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –¢—ã –ø–æ–±–µ–¥–∏–ª!"></textarea>

  <button id="generateBtn">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å iframe</button>

  <div id="embedCodeBox">
    <p>–°–∫–æ–ø–∏—Ä—É–π —ç—Ç–æ—Ç –∫–æ–¥ –∏ –≤—Å—Ç–∞–≤—å –≤ Genially:</p>
    <textarea id="embedCode" readonly></textarea>
  </div>

<script>
function cleanList(raw){
  return raw.split(/[\n,]+/).map(x=>x.trim()).filter(x=>x);
}
<script>
function cleanList(raw){
  return raw.split(/[\n,]+/).map(x=>x.trim()).filter(x=>x);
}

/* ‚úö –ù–û–í–û–ï: –ø—É–±–ª–∏–∫–∞—Ü–∏—è JSON –Ω–∞ —Å–µ—Ä–≤–µ—Ä –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ id */
async function publishToServer(payload, idHint="domino") {
  const id = idHint.replace(/[^\w-]+/g,'').toLowerCase() + "-" + Date.now();
  const res = await fetch("https://server-kjnn.onrender.com/publish", {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "X-Publish-Key": "nika_read_pub_2025"
    },
    body: JSON.stringify({
      id,                           // id —Ñ–∞–π–ª–∞ (–∏–º—è –±–µ–∑ .json)
      folder: "texts/data",         // –ø–∞–ø–∫–∞ –Ω–∞ GitHub Pages
      content: payload              // —Å–∞–º JSON (–æ–±—ä–µ–∫—Ç)
    })
  });
  if (!res.ok) {
    const msg = await res.text().catch(()=>res.statusText);
    throw new Error("Publish failed: " + msg);
  }
  return id;
}

document.getElementById("generateBtn").addEventListener("click", async ()=>{
  const A = cleanList(document.getElementById("listA").value);
  const B = cleanList(document.getElementById("listB").value);
  const freeMode = document.getElementById("freeMode").checked;
  const useServer = document.getElementById("useServer").checked;

  if (!A.length){
    alert("–°–ø–∏—Å–æ–∫ A –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω!");
    return;
  }

  const feedback = document.getElementById("feedbackText").value || "–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!";
  const data = {listA:A, listB:B, freeMode, feedback};

  let file = "";
  if (freeMode && B.length) file = "main-free-double.html";
  else if (freeMode && !B.length) file = "main-free-single.html";
  else if (!freeMode && B.length) file = "main-double.html";
  else file = "main-classic.html";

  const base = "https://nikashum93.github.io/dominooo/";

  let url;
  if (useServer) {
    try {
      // ‚úö –ø—É–±–ª–∏–∫—É–µ–º JSON, –ø–æ–ª—É—á–∞–µ–º –∫–æ—Ä–æ—Ç–∫–∏–π id
      const id = await publishToServer(data, A[0] || "domino");
      url = `${base}${file}?id=${encodeURIComponent(id)}`;
    } catch (e) {
      console.error(e);
      alert("–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä: " + e.message + "\n–°–¥–µ–ª–∞—é –ª–æ–∫–∞–ª—å–Ω—ã–π ?data –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏.");
      const json = encodeURIComponent(JSON.stringify(data));
      url = `${base}${file}?data=${json}`;
    }
  } else {
    // —Å—Ç–∞—Ä—ã–π —Ä–µ–∂–∏–º —Å ?data
    const json = encodeURIComponent(JSON.stringify(data));
    url = `${base}${file}?data=${json}`;
  }

  const code = `<iframe src="${url}" width="960" height="540" style="border:0;" allowfullscreen></iframe>`;
  document.getElementById("embedCode").value = code;
  document.getElementById("embedCodeBox").style.display = "block";
});


/* –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–µ—Ä—Ö–Ω–µ–π –≥–∏—Ä–ª—è–Ω–¥—ã */
function generateGarland(id, step=40){
  const container = document.getElementById(id);
  const count = Math.floor(window.innerWidth / step);
  for (let i=0; i<count; i++){
    const span = document.createElement("span");
    container.appendChild(span);
  }
}
generateGarland("garlandTop", 40);
</script>
</body>
</html>
