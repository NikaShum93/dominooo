<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Domino Editor</title>

<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º —à—Ä–∏—Ñ—Ç Inter -->
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
  body{
    margin:0;
    padding:0;
    background: url("https://img.genially.com/64233afb55129a0017751c8e/80454769-7ad4-4911-b11a-636485807651.jpeg") no-repeat center center fixed;
    background-size:cover;
    font:18px "Inter", sans-serif;
    color:#fdf4ff;
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:flex-start;
    min-height:100vh;
    text-align:center;
    position:relative;
    overflow:auto; /* —É–±–∏—Ä–∞–µ–º —Å–∫—Ä–æ–ª–ª */
  }

  h1{
    margin:10px 0;
    font-size:2.6em;
    color:#ffeeb0;
    text-shadow:0 0 8px #ffae00, 0 0 16px #d06bff;
    position:relative; z-index:2;
  }

  .logo{
    margin:10px auto 0;
    width:120px;
    filter: drop-shadow(0 0 10px #ffda8b);
    position:relative; z-index:2;
  }

  /* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è —Å–ø–∏—Å–∫–æ–≤ */
.lists{
  display: grid;
  grid-template-columns: 460px 460px;  /* —Ñ–∏–∫—Å. —à–∏—Ä–∏–Ω–∞ –∫–æ–ª–æ–Ω–æ–∫ */
  justify-content: center;
  gap: 20px;
  width: 100%;
  max-width: none;
  margin: 10px auto;
  position: relative;
  z-index: 2;
}

.list-col{
  display: grid;
  grid-template-rows: auto 1fr; /* –∑–∞–≥–æ–ª–æ–≤–æ–∫ + –ø–æ–ª–µ */
  min-width: 0;
}

.list-col p{
  display:flex;
  align-items:center;
  margin:0 0 8px;
  padding:8px 14px;
  border-radius:8px;
  background:rgba(46,25,56,0.6);
  box-shadow:0 0 8px rgba(255,126,255,.4);

  white-space:nowrap;       /* –±–µ–∑ –ø–µ—Ä–µ–Ω–æ—Å–æ–≤ */
  overflow:hidden;
  text-overflow:ellipsis;   /* —Ç—Ä–æ–µ—Ç–æ—á–∏–µ, –µ—Å–ª–∏ –≤–¥—Ä—É–≥ –Ω–µ –≤–ª–µ–∑–µ—Ç */
}

.lists .list-col textarea{
  width:100%;
  min-height:140px;
  padding:14px 16px;
  border-radius:12px;
  border:2px solid #ffda8b;
  background:rgba(255,255,255,0.9);
  color:#2c1a32;
  font-size:16px;
  box-shadow:0 0 10px rgba(255,218,139,.6);
}


  label{
    margin:10px auto;
    display:flex;
    align-items:center;
    gap:8px;
    font-size:16px;
    background:rgba(46,25,56,0.6);
    padding:8px 14px;
    border-radius:8px;
    max-width:650px;
    box-shadow:0 0 8px rgba(255,126,255,.4);
    position:relative; z-index:2;
  }

  p.feedback-label {
    font-size:16px;
    background:rgba(46,25,56,0.6);
    padding:8px 14px;
    border-radius:8px;
    margin:12px auto;
    max-width:650px;
    box-shadow:0 0 8px rgba(255,126,255,.4);
    position:relative; z-index:2;
  }

  textarea#feedbackText {
    width:90%;
    max-width:800px;
    min-height:80px;
    margin:12px auto;
    padding:14px 16px;
    border-radius:12px;
    border:2px solid #ffda8b;
    background:rgba(255,255,255,0.9);
    color:#2c1a32;
    font-size:16px;
    box-shadow:0 0 10px rgba(255,218,139,.6);
    display:block;
    position:relative; z-index:2;
  }

  button{
    padding:14px 28px; border-radius:12px; border:none;
    background:linear-gradient(90deg,#ffda8b,#ff7eff);
    color:#2c1a32; cursor:pointer; font-weight:700; font-size:18px; margin:16px 0;
    box-shadow:0 0 12px rgba(255,218,139,.8),0 0 20px rgba(208,107,255,.7);
    transition:transform .2s, box-shadow .2s;
    position:relative; z-index:2;
  }
  button:hover{
    transform:scale(1.05);
    box-shadow:0 0 16px #ffda8b,0 0 28px #d06bff;
  }

#embedCodeBox{
  display:none;                 /* –ø–æ–∫–∞–∂–µ–º –ø–æ—Å–ª–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ */
  margin-top:12px;
  width:90%;
  max-width:800px;
  text-align:center;
  position:relative;
  z-index:2;
}

#embedCode{
  width:100%;
  min-height:120px;             /* —á—É—Ç—å –≤—ã—à–µ –±–∞–∑–æ–≤–∞—è –≤—ã—Å–æ—Ç–∞ */
  max-height:320px;             /* –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º, —á—Ç–æ–±—ã –Ω–µ —Ä–∞–∑—ä–µ–∑–∂–∞–ª–∞—Å—å –≤–µ—Ä—Å—Ç–∫–∞ */
  overflow:auto;                /* —Å–æ–±—Å—Ç–≤–µ–Ω–Ω–∞—è –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–Ω—É—Ç—Ä–∏ –ø–æ–ª—è */
  resize:vertical;              /* –º–æ–∂–Ω–æ —Ä–∞—Å—Ç—è–≥–∏–≤–∞—Ç—å –º—ã—à–∫–æ–π –≤–Ω–∏–∑/–≤–≤–µ—Ä—Ö */
  padding:14px;
  border-radius:12px;
  background:rgba(30,16,34,0.9);
  color:#ffda8b;
  font-family:monospace;
  font-size:15px;
  border:2px solid #ff7eff;
  box-shadow:0 0 12px rgba(255,126,255,.6);
  text-align:left;
  display:block;
  margin:0 auto;
}

  /* –≥–∏—Ä–ª—è–Ω–¥–∞ */
  .garland{
    position:fixed;
    top:10px;
    left:0;
    width:100%;
    display:flex;
    justify-content:space-evenly;
    pointer-events:none;
    z-index:1;
  }
  .garland span{
    width:20px; height:20px; border-radius:50%;
    background:#ffda8b; box-shadow:0 0 8px #ffda8b;
    animation: blink 1.5s infinite alternate;
  }
  .garland span:nth-child(2n){background:#ff7eff; box-shadow:0 0 8px #ff7eff; animation-delay:.3s}
  .garland span:nth-child(3n){background:#7ef9ff; box-shadow:0 0 8px #7ef9ff; animation-delay:.6s}
  @keyframes blink{from{opacity:.4} to{opacity:1}}
  /* –ü–∞–Ω–µ–ª–∏ */
.panel{
  width: 90%;
  max-width: 1000px;
  margin: 12px auto;
  padding: 12px 14px;
  background: rgba(46,25,56,.55);
  border: 1.5px solid rgba(255,218,139,.45);
  border-radius: 12px;
  box-shadow: 0 0 10px rgba(255,126,255,.35);
}
.panel-title{
  margin: 0 0 8px;
  font-size: 18px;
  color:#ffeeb0;
  text-shadow: 0 0 6px #ffae00;
  font-weight: 700;
  text-align: left;
}

/* –í–µ—Ä—Ö–Ω—è—è –ø–∞–Ω–µ–ª—å ‚Äî –≤ –æ–¥–Ω—É —Å—Ç—Ä–æ–∫—É –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ */
.panel-top .row{
  display:flex; gap:12px; align-items:center; justify-content:center; flex-wrap:wrap;
}
.panel-top .check, .panel-top .lang{
  background: rgba(0,0,0,.15);
  padding:8px 10px; border-radius:10px; border:1px solid rgba(255,218,139,.35);
  display:flex; align-items:center; gap:8px;
}
.panel-top select{
  padding:6px 10px; border-radius:8px; border:1px solid #ffda8b; background:#fff; color:#2c1a32;
}

/* –ó–∞–¥–∞–Ω–∏—è */
.lists{ width:100%; max-width:none; margin: 0; }
.list-col p{ margin:0 0 6px; }

/* –õ–∏–Ω–µ–π–Ω–æ–µ –ø–æ–ª–µ —Ñ–∏–¥–±–µ–∫–∞ */
.input-line{
  width:100%;
  max-width: 800px;
  padding:12px 14px;
  border-radius:10px;
  border:2px solid #ffda8b;
  background:rgba(255,255,255,0.9);
  color:#2c1a32;
  font-size:16px;
  box-shadow:0 0 10px rgba(255,218,139,.6);
  display:block;
  margin: 4px auto 0;
}

/* –ö–Ω–æ–ø–∫–∞ + —á–µ–∫–±–æ–∫—Å –ø–µ—Ä–µ–¥–∞—á–∏ –Ω–∏–∂–µ */
.actions{ text-align:center; }
.actions .under-btn{ display:block; margin-top:8px; text-align:center; }

@media (max-width: 980px){
  .lists{
    grid-template-columns: 1fr;  /* –∫–æ–ª–æ–Ω–∫–∏ –≤ —Å—Ç–æ–ª–±–∏–∫ */
    max-width: 560px;
  }
  .list-col p{
    white-space: normal;   /* –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö –º–æ–∂–Ω–æ –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—å */
    text-overflow: clip;
  }
}

</style>
</head>
<body>

  <!-- –≤–µ—Ä—Ö–Ω—è—è –≥–∏—Ä–ª—è–Ω–¥–∞ -->
  <div class="garland" id="garlandTop"></div>

  <img src="https://con.xl.ru/fnfLZuvpAUiDaqDs8d1-2g/images/kcJYv7OsYUSGt5AfGq5jIw.png" alt="–õ–æ–≥–æ –ö–ì–ë" class="logo">
  <h1>–ö–ì–ë ¬∑ –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ "–î–æ–º–∏–Ω–æ"</h1>

<!-- 1) –ü–∞–Ω–µ–ª—å –Ω–∞—Å—Ç—Ä–æ–µ–∫ -->
<section class="panel panel-top">
  <div class="row">
    <label class="check"><input type="checkbox" id="freeMode"> –°–≤–æ–±–æ–¥–Ω–∞—è –∏–≥—Ä–∞</label>

    <label class="lang">
      –Ø–∑—ã–∫:
      <select id="language">
        <option value="ru" selected>–†—É—Å—Å–∫–∏–π</option>
        <option value="en">English</option><option value="fr">Fran√ßais</option>
        <option value="es">Espa√±ol</option><option value="de">Deutsch</option>
        <option value="zh">‰∏≠Êñá</option><option value="ja">Êó•Êú¨Ë™û</option>
      </select>
    </label>

    <label class="check"><input type="checkbox" id="mathMode"> LaTeX –Ω–∞ –∫–æ—Å—Ç—è—à–∫–∞—Ö</label>
  </div>
</section>

<!-- 2) –ó–∞–¥–∞–Ω–∏—è (A/B) -->
<section class="panel">
  <h2 class="panel-title">–ó–∞–¥–∞–Ω–∏—è</h2>
  <div class="lists">
    <div class="list-col">
      <p>–°–ø–∏—Å–æ–∫ A (—Å–ª–æ–≤–∞ –∏–ª–∏ —Å—Å—ã–ª–∫–∏ –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫–∏)</p>
      <textarea id="listA" placeholder="CAT, DOG, SUN, MOON"></textarea>
    </div>
    <div class="list-col">
      <p>–°–ø–∏—Å–æ–∫ B (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∫–∞—Ä—Ç–∏–Ω–∫–∏ –∏–ª–∏ —Å–ª–æ–≤–∞ –¥–ª—è –ø–∞—Ä)</p>
      <textarea id="listB" placeholder="üê±, üê∂, ‚òÄÔ∏è, üåô"></textarea>
    </div>
  </div>
</section>

<!-- 3) –§–∏–¥–±–µ–∫ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–æ–π -->
<section class="panel">
  <h2 class="panel-title">–§–∏–Ω–∞–ª—å–Ω—ã–π —Ñ–∏–¥–±–µ–∫</h2>
  <input id="feedbackText" type="text" placeholder="–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º! –¢—ã –ø–æ–±–µ–¥–∏–ª!" class="input-line">
</section>

<!-- 4) –ö–Ω–æ–ø–∫–∞ –∏ –ø–µ—Ä–µ–¥–∞—á–∞ –¥–∞–Ω–Ω—ã—Ö -->
<section class="panel actions">
  <button id="generateBtn">–°–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å iframe</button>
  <label class="check under-btn">
    <input type="checkbox" id="useServer"> –ü—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä (–∫–æ—Ä–æ—Ç–∫–∏–π iframe —Å ?id=)
  </label>
</section>
  <div id="embedCodeBox">
    <p>–°–∫–æ–ø–∏—Ä—É–π —ç—Ç–æ—Ç –∫–æ–¥ –∏ –≤—Å—Ç–∞–≤—å –≤ Genially:</p>
    <textarea id="embedCode" readonly></textarea>
  </div>

<script>
function cleanList(raw){
  return raw.split(/[\n,]+/).map(x=>x.trim()).filter(x=>x);
}

const ENDPOINT    = "https://server-kjnn.onrender.com/publish";
const PUBLISH_KEY = "nika_read_pub_2025";

async function publishToServer(dataObj, idHint = "domino"){
  const slug = (idHint || "domino")
    .toLowerCase()
    .normalize('NFKD').replace(/[\u0300-\u036f]/g,'')
    .replace(/[^a-z0-9-]+/g,'-').replace(/^-+|-+$/g,'')
    .slice(0,40) || "domino";
  const d=new Date(),p=n=>String(n).padStart(2,'0');
  const stamp = `${d.getFullYear()}${p(d.getMonth()+1)}${p(d.getDate())}-${p(d.getHours())}${p(d.getMinutes())}${p(d.getSeconds())}`;
  const id = `${slug}-${stamp}`;

const payload = {
  id,
  mode: "json",                 // ‚Üê –∫–∞–∫ –≤ —Ä–∞–±–æ—á–µ–º –ø—Ä–æ–µ–∫—Ç–µ
  folder: "data",               // ‚Üê –∏–º–µ–Ω–Ω–æ "data"
  content: JSON.stringify(dataObj, null, 2)
};

  const res = await fetch(ENDPOINT, {
    method: "POST",
    headers: {
      "Content-Type": "application/json",
      "X-Publish-Key": PUBLISH_KEY
    },
    body: JSON.stringify(payload)
  });

  if(!res.ok){
    const msg = await res.text().catch(()=>res.statusText);
    throw new Error(msg || "Server error");
  }
  return id;
}


document.getElementById("generateBtn").addEventListener("click", async ()=>{
 const A = cleanList(document.getElementById("listA").value);
const B = cleanList(document.getElementById("listB").value);
const freeMode = document.getElementById("freeMode").checked;
const useServer = document.getElementById("useServer").checked;

// –ù–û–í–û–ï:
const language = document.getElementById("language").value || 'ru';
const mathMode = document.getElementById("mathMode").checked;

if(!A.length){ alert("–°–ø–∏—Å–æ–∫ A –æ–±—è–∑–∞—Ç–µ–ª–µ–Ω!"); return; }

const feedback = (document.getElementById("feedbackText").value || "–ü–æ–∑–¥—Ä–∞–≤–ª—è–µ–º!").trim();
const data = { listA:A, listB:B, freeMode, feedback, language, mathMode };


  let file = "";
  if (freeMode && B.length) file = "main-free-double.html";
  else if (freeMode && !B.length) file = "main-free-single.html";
  else if (!freeMode && B.length) file = "main-double.html";
  else file = "main-classic.html";

  const base = "https://nikashum93.github.io/dominooo/";
  let url;

  if (useServer){
    try{
      const id = await publishToServer(data, A[0] || "domino");
      url = `${base}${file}?id=${encodeURIComponent(id)}`;
    }catch(e){
      alert("–ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä: " + e.message + "\n–°–¥–µ–ª–∞—é –ª–æ–∫–∞–ª—å–Ω—ã–π ?data –¥–ª—è –Ω–∞–¥—ë–∂–Ω–æ—Å—Ç–∏.");
      url = `${base}${file}?data=${encodeURIComponent(JSON.stringify(data))}`;
    }
  } else {
    url = `${base}${file}?data=${encodeURIComponent(JSON.stringify(data))}`;
  }

  const code = `<iframe src="${url}" width="960" height="540" style="border:0;" allowfullscreen></iframe>`;
  document.getElementById("embedCode").value = code;
  document.getElementById("embedCodeBox").style.display = "block";
});

/* –≥–∏—Ä–ª—è–Ω–¥–∞ */
function generateGarland(id, step=40){
  const container = document.getElementById(id);
  const count = Math.floor(window.innerWidth / step);
  for (let i=0; i<count; i++){
    const span = document.createElement("span");
    container.appendChild(span);
  }
}
generateGarland("garlandTop", 40);
</script>

</body>
</html>
